CAN_immigration = {

	CAN_give_asylum_to_british_refugees = {
		
		icon = generic_political_discourse
		
		available = {
		
		}
		
		activation = {
			has_democratic_government = yes
			any_country = {
				original_tag = ENG
				NOT = { has_democratic_government = yes }
				has_civil_war = no
			}
		}
		
		allowed = {
			original_tag = CAN
		}
		
		cancel_trigger = {
		
		}
		
		selectable_mission = yes
		
		days_mission_timeout = 30
		
		fire_only_once = yes
		
		cost = 0
		
		timeout_effect = {
		
		}

		complete_effect = {
			if = {
				limit = {
					any_owned_state = {
						state_population > 200000
					}
				}
				capital_scope = {
					add_manpower = 30000
				}
				random_owned_state = {
					prioritize = { 468 }
					limit = {
						state_population > 200000
					}
					add_manpower = 50000
				}
				random_owned_state = {
					prioritize = { 466 }
					limit = {
						state_population > 200000
					}
					add_manpower = 10000
				}
				random_owned_state = {
					prioritize = { 465 }
					limit = {
						state_population > 200000
					}
					add_manpower = 40000
				}
				random_owned_state = {
					prioritize = { 464 }
					limit = {
						state_population > 200000
					}
					add_manpower = 70000
				}
			}
			else = {
				capital_scope = {
					add_manpower = 30000
				}
				random_owned_state = {
					prioritize = { 468 }
					add_manpower = 50000
				}
				random_owned_state = {
					prioritize = { 466 }
					add_manpower = 10000
				}
				random_owned_state = {
					prioritize = { 465 }
					add_manpower = 40000
				}
				random_owned_state = {
					prioritize = { 464 }
					add_manpower = 70000
				}
			}
			random_country = {
				limit = {
					original_tag = ENG
				}
				country_event = { id = tfv_canada.120 }
			}
		}
		
		ai_will_do = {
			factor = 100			
		}
	}
	
	CAN_post_war_european_immigration = {
		
		icon = generic_political_discourse
		
		available = {
			has_democratic_government = yes
			has_war = no
			if = {
				limit = {
					has_idea = CAN_great_depression_1
				}
				NOT = { has_idea = CAN_great_depression_1 }
			}
			if = {
				limit = {
					has_idea = CAN_great_depression_2
				}
				NOT = { has_idea = CAN_great_depression_2 }
			}
		}
		
		allowed = {
			tag = CAN
		}
		
		visible = {
			date > 1942.1.1
			OR = {
				has_completed_focus = CAN_strengthen_the_commonwealth_ties
				has_completed_focus = CAN_permanent_joint_defense_board
			}
			has_democratic_government = yes
		}
		
		fire_only_once = yes
		
		cost = 10

		complete_effect = {
			add_timed_idea = { 
				idea = CAN_post_war_refugees
				days = 1460
			}
		}
		
		remove_effect = {
		
		}
		
		ai_will_do = {
			factor = 100			
		}
	}
}

CAN_support_america = {

	CAN_support_america = {
		
		icon = generic_construction
		
		available = {
			has_completed_focus = CAN_permanent_joint_defense_board
			USA = {
				has_democratic_government = yes
			}
			USA = {
				has_idea = great_depression
			}
		}
		
		allowed = {
			tag = CAN
		}
		
		visible = {
			USA = {
				has_democratic_government = yes
			}
			has_democratic_government = yes
			NOT = {
				OR = {
					has_completed_focus = CAN_swastika_clubs
					has_completed_focus = CAN_burn_the_royal_portraits
				}
			}
			has_completed_focus = CAN_patriation
			USA = {
				has_idea = great_depression
			}
		}

		highlight_states = {
		
		}
		
		fire_only_once = yes
		
		modifier = {
			
		}
		
		cost = 25

		complete_effect = {
			USA = {
				country_event = { id = tfv_canada.80 hours = 6 }
			}
		}
		
		remove_effect = {
			
		}
		
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0.5
				has_idea = CAN_great_depression_1
			}
			modifier = {
				factor = 0.75
				has_idea = CAN_great_depression_2
			}
			modifier = {
				factor = 5
				NOT = {
					has_idea = CAN_great_depression_1
					has_idea = CAN_great_depression_2
				}
			}
			modifier = {
				factor = 0
				USA = { has_autocratic_government = yes }
			}
		}
	}
}

CAN_loan_payments = {

	CAN_loan_payment_plan_no_1 = {
		
		icon = generic_construction
		
		available = {
			USA = {
				NOT = { has_idea = great_depression }
				has_full_control_of_state = 463
				has_full_control_of_state = 727
			}
			is_in_faction_with = USA
			NOT = {	has_country_flag = CAN_payment_selected }
			custom_trigger_tooltip = {
				NOT  = { has_idea = CAN_great_depression_1 }
				tooltip = CAN_has_revived_the_canada_wheat_board_tt
			}
		}
		
		allowed = {
			tag = CAN
		}
		
		visible = {
		#	date > 1939.1.01
			NOT = { has_country_flag = CAN_loan_payment_plan_no_1 }
			NOT = { has_country_flag = CAN_payment_accepted }
			USA = {
				NOT = { has_idea = great_depression }
				has_country_flag = canadian_loans
			}
		}

		highlight_states = {
		
		}
		
		fire_only_once = yes
		
		modifier = {
			
		}
		
		cost = 100

		complete_effect = {
			set_country_flag = CAN_loan_payment_plan_no_1
			set_country_flag = CAN_payment_selected
			USA = {
				country_event = { id = tfv_canada.90 hours = 6 }
			}
		}
		
		remove_effect = {
			
		}
		
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0.5
				USA = { has_war_with = JAP }
			}
			modifier = {
				factor = 2
				OR = {
					has_country_flag = CAN_loan_payment_plan_no_2
					has_country_flag = CAN_loan_payment_plan_no_3
				}
			}
		}
	}
	
	CAN_loan_payment_plan_no_2 = {
		
		icon = generic_construction
		
		available = {
			USA = {
				NOT = { has_idea = great_depression }
			}
			NOT = {	has_country_flag = CAN_payment_selected }
			custom_trigger_tooltip = {
				NOT  = { has_idea = CAN_great_depression_1 }
				tooltip = CAN_has_revived_the_canada_wheat_board_tt
			}
		}
		
		allowed = {
			tag = CAN
		}
		
		visible = {
		#	date > 1939.1.01
			NOT = { has_country_flag = CAN_loan_payment_plan_no_2 }
			NOT = { has_country_flag = CAN_payment_accepted }
			USA = {
				NOT = { has_idea = great_depression }
				has_country_flag = canadian_loans
			}
		}

		highlight_states = {
		
		}
		
		fire_only_once = yes
		
		modifier = {
			
		}
		
		cost = 100

		complete_effect = {
			set_country_flag = CAN_payment_selecteds
			set_country_flag = CAN_loan_payment_plan_no_2
			USA = {
				country_event = { id = tfv_canada.93 hours = 6 }
			}
		}
		
		remove_effect = {
			
		}
		
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0.5
				num_of_military_factories > 50
			}
			modifier = {
				factor = 2
				OR = {
					has_country_flag = CAN_loan_payment_plan_no_1
					has_country_flag = CAN_loan_payment_plan_no_3
				}
			}
		}
	}
	
	CAN_loan_payment_plan_no_3 = {
		
		icon = generic_construction
		
		available = {
			USA = {
				NOT = { has_idea = great_depression }
			}
			NOT = {	has_country_flag = CAN_payment_selected }
			if = {
				limit = {
					has_idea = CAN_great_depression_1
				}
				NOT = { 
					has_idea = CAN_great_depression_1
				}
			}
			if = {
				limit = {
					has_idea = CAN_great_depression_2
				}
				NOT = { 
					has_idea = CAN_great_depression_2
				}
			}
			custom_trigger_tooltip = {
				NOT  = { has_idea = CAN_great_depression_1 }
				tooltip = CAN_has_revived_the_canada_wheat_board_tt
			}
		}
		
		allowed = {
			tag = CAN
		}
		
		visible = {
		#	date > 1939.1.01
			NOT = { has_country_flag = CAN_loan_payment_plan_no_3 }
			NOT = { has_country_flag = CAN_payment_accepted }
			USA = {
				has_country_flag = canadian_loans
				NOT = { has_idea = great_depression }
			}
		}

		highlight_states = {
		
		}
		
		fire_only_once = yes
		
		modifier = {
			
		}
		
		cost = 100

		complete_effect = {
			set_country_flag = CAN_payment_selected
			set_country_flag = CAN_loan_payment_plan_no_3
			USA = {
				country_event = { id = tfv_canada.96 hours = 6 }
			}
		}
		
		remove_effect = {
			
		}
		
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0.5
				has_manpower > 250000
			}
			modifier = {
				factor = 0.5
				has_army_manpower = { size > 500000 }
			}
			modifier = {
				factor = 2
				OR = {
					has_country_flag = CAN_loan_payment_plan_no_2
					has_country_flag = CAN_loan_payment_plan_no_1
				}
			}
		}
	}
}
